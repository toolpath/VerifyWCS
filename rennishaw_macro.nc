(O8901)
(WCS VERIFICATION)

(X - EXPECTED X OFFSET #24)
(Y - EXPECTED Y OFFSET #25)
(Z - EXPECTED Z OFFSET #26)
(W - WCS OFFSET #23)
(E - ALLOWABLE ERROR #8)

(FIND THE CORRECT WCS REGISTERS)

IF[[#23GT53] AND [#23LT60]] GOTO1 (NORMAL WORK OFFSETS)
IF[#23GT100] GOTO2 (EXTENDED WORK OFFSETS)
IF[#23GT59] GOTO999 (INVALID WORK OFFSET)
GOTO999

N1 #100 = #[5221+[#23-54]*20]
#101 = #[5222+[#23-54]*20]
#102 = #[5223+[#23-54]*20]
GOTO3


(EXTENDED WORK OFFSETS)
N2 #100 = #[7001+[#23-101]*20] 
#101 = #[7001+[#23-101]*20]
#102 = #[7001+[#23-101]*20]
GOTO3

N3 (WCS CHECK)

#104 = ABS[#100 - #24] (X ERROR)
#105 = ABS[#101 - #25] (Y ERROR)
#106 = ABS[#102 - #26] (Z ERROR)


IF[#104GT#8]GOTO4

IF[#105GT#8]GOTO5

IF[#106GT#8]GOTO6
GOTO7

N4
#3000 = 6(X WCS IN WRONG PLACE)
N5
#3000 = 6(Y WCS IN WRONG PLACE)
N6
#3000 = 6(Z WCS IN WRONG PLACE)

(IF YOU GOT HERE THEN ALL IS GOOD)
N7M99 

N999 #3000 = 6(BAD WORK OFFSET VALUE)
